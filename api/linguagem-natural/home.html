<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assistente Virtual</title>
</head>
<a></a>
<body>
  <h1>Assistente Virtual</h1>
  <p id="comando">Comando reconhecido: </p>
  <p id="resposta">Resposta: </p>

  <script>
    // Configuração do reconhecimento de voz
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = 'pt-BR'; // Define o idioma para português do Brasil
    recognition.interimResults = false;

    // Função para transformar texto em fala
    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'pt-BR';
      utterance.rate = 1; // Velocidade normal
      window.speechSynthesis.speak(utterance);
    }

    recognition.onresult = async (event) => {
      const comando = event.results[0][0].transcript; // Texto do comando reconhecido
      document.getElementById('comando').innerText = `Comando reconhecido: ${comando}`;

      try {
        // Enviar o comando para a API
        const response = await fetch('http://localhost:3000/comando', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ comando })
        });

        if (response.ok) {
          const data = await response.json();
          const resposta = data.resposta; // Resposta retornada pela API
          document.getElementById('resposta').innerText = `Resposta: ${resposta}`;
          
          // Fazer a assistente falar a resposta
          speak(resposta);
        } else {
          document.getElementById('resposta').innerText = `Erro ao obter resposta: ${response.status}`;
          speak("Desculpe, ocorreu um erro ao processar o comando.");
        }
      } catch (error) {
        document.getElementById('resposta').innerText = `Erro: ${error.message}`;
        speak("Desculpe, não consegui processar o comando.");
      }
    };

    // Inicia o reconhecimento de voz quando a página carregar
    recognition.start();

    recognition.onend = () => {
      recognition.start(); // Reinicia automaticamente o reconhecimento de voz
    };
  </script>
</body>
</html>
